<!-- friends.component.html -->
<div class="container mt-4">
    <h2>Znajomi</h2>
  
    <!-- Formularz wysyłania zaproszenia -->
    <div class="card mb-4">
      <div class="card-header">
        <h4>Wyślij zaproszenie do znajomych</h4>
      </div>
      <div class="card-body">
        <form (ngSubmit)="sendFriendRequest()">
          <div class="input-group">
            <input 
              type="text" 
              class="form-control" 
              placeholder="ID użytkownika"
              [formControl]="recipientIdControl"
            >
            <button 
              class="btn btn-primary" 
              type="submit"
              [disabled]="isLoading"
            >
              <span *ngIf="isLoading" class="spinner-border spinner-border-sm me-1"></span>
              Wyślij zaproszenie
            </button>
          </div>
        </form>
      </div>
    </div>
  
    <!-- Lista zaproszeń -->
    <div class="card mb-4">
      <div class="card-header">
        <h4>Zaproszenia do znajomych</h4>
      </div>
      <div class="card-body">
        <div *ngIf="isLoading" class="text-center">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Ładowanie...</span>
          </div>
        </div>
  
        <div *ngIf="!isLoading && friendRequests.length === 0" class="text-center text-muted">
          Brak zaproszeń do znajomych
        </div>
  
        <ul class="list-group" *ngIf="friendRequests.length > 0">
          <li class="list-group-item d-flex justify-content-between align-items-center" *ngFor="let request of friendRequests">
            <div class="d-flex align-items-center">
              <div>
                <h5 class="mb-0">{{ request.senderUsername }}</h5>
                @if (request.profilePhotoUrl === null) {
                  <img src="assets/images/default-user.jpg" alt="Sender Photo" class="img-fluid rounded my-2" style="max-width: 100px;">
                }
                @else {
                  <img [src]="request.profilePhotoUrl" alt="Sender Photo" class="img-fluid rounded my-2" style="max-width: 100px;">
                }
                <small class="text-muted">ID: {{ request.senderId }}</small>
              </div>
            </div>
            <div class="btn-group">
              <button class="btn btn-success btn-sm" (click)="acceptFriendRequest(request.id)" [disabled]="isLoading">
                Akceptuj
              </button>
              <button class="btn btn-danger btn-sm" (click)="declineFriendRequest(request.id)" [disabled]="isLoading">
                Odrzuć
              </button>
            </div>
          </li>
        </ul>
      </div>
    </div>
  
    <!-- Lista znajomych -->
    <div class="card">
      <div class="card-header">
        <h4>Moi znajomi</h4>
      </div>
      <div class="card-body">
        <div *ngIf="isLoading" class="text-center">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Ładowanie...</span>
          </div>
        </div>
  
        <div *ngIf="!isLoading && friends.length === 0" class="text-center text-muted">
          Nie masz jeszcze znajomych
        </div>
  
        <ul class="list-group" *ngIf="friends.length > 0">
          <li class="list-group-item d-flex align-items-center" *ngFor="let friend of friends">
            <div class="d-flex align-items-center">
              <img 
                *ngIf="friend.profilePhotoUrl" 
                [src]="friend.profilePhotoUrl" 
                class="rounded-circle me-2" 
                width="40" 
                height="40" 
                alt="Zdjęcie profilowe"
              >
              <div *ngIf="!friend.profilePhotoUrl" class="bg-primary rounded-circle me-2 d-flex justify-content-center align-items-center" style="width: 40px; height: 40px;">
                <span class="text-white">{{ friend.username.charAt(0).toUpperCase() }}</span>
              </div>
              <div>
                <h5 class="mb-0">{{ friend.name || friend.username }}</h5>
                <small class="text-muted">{{ friend.username }}</small>
              </div>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
